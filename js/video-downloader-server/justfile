# Video Downloader Server - justfile

# Conditional docker command (use sudo on Linux, not on macOS)
docker := if os() == "linux" { "sudo docker" } else { "docker" }

# List all available recipes
default:
    @just --list

# Install dependencies
install:
    npm install

# Run server in development mode
dev:
    npm run dev

# Build TypeScript to dist/
build:
    npm run build

# Start production server
start:
    npm run start

# Build Docker image
docker-build:
    {{docker}} build -t video-downloader-server .

# Run Docker container
docker-run:
    {{docker}} run -p 3000:3000 --rm --name video-downloader-server video-downloader-server

# Build and run Docker container
docker-build-and-run: docker-build docker-run

# Show Docker container logs
docker-logs:
    {{docker}} logs video-downloader-server

# Clean dist directory and Docker images
clean:
    rm -rf dist/
    {{docker}} rmi video-downloader-server 2>/dev/null || true